!function(c){"use strict";c.fn.colorPicker=function(e){return this.each(function(){new c.colorPicker(this,e||{})})},c.colorPicker=function(e,o){this.options=c.extend({},c.fn.colorPicker.defaults,o=o||{}),o.str&&(this.options.str=c.extend({},c.fn.colorPicker.defaults.str,o.str)),c.fn.colorPicker.defaults=this.options,this.color=this.options.initialColor.toUpperCase(),this.element=c(e);var o=this.element.data("initialcolor"),t=(o&&(this.color=o,this.appendToStorage(this.color)),[]);return c.each(c.fn.colorPicker.defaults.palette.map(function(e){return e.toUpperCase()}),function(e,o){-1===c.inArray(o,t)&&t.push(o)}),this.palette=t,this.element.hasClass(this.options.pickerClass)?this:this.init()},c.fn.colorPicker.defaults={initialColor:"",paletteLabel:"Colors:",allowRecent:!0,recentMax:5,recentLabel:"Recents:",allowCustomColor:!1,palette:["#1abc9c","#16a085","#2ecc71","#27ae60","#3498db","#2980b9","#9b59b6","#8e44ad","#34495e","#2c3e50","#f1c40f","#f39c12","#e67e22","#d35400","#e74c3c","#c0392b","#ecf0f1","#bdc3c7","#95a5a6","#7f8c8d"],onColorSelected:function(){this.color&&this.element.css({"background-image":"none"}),this.element.css({"background-color":this.color,color:this.color})}},c.colorPicker.prototype={init:function(){var t=this;this.options;return c.proxy(c.fn.colorPicker.defaults.onColorSelected,this)(),this.element.click(function(e){var o;if(e.target==e.currentTarget)return o=c(t.element).offset(),e.preventDefault(),t.show(t.element,e.pageX-o.left,e.pageY-o.top),c(".color-custom-hash").val(t.color),c(".color-picker-button").click(function(e){return t.color=c(e.target).attr("hexValue"),t.appendToStorage(c(e.target).attr("hexValue")),t.hide(),c.proxy(t.options.onColorSelected,t)(),!1}),c(".color-custom-hash").click(function(e){return!1}).keyup(function(e){var o=c(this).val();0!==o.indexOf("#")&&(o="#"+o),/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(o)?(t.color=o,t.appendToStorage(o),c.proxy(t.options.onColorSelected,t)(),c(this).removeClass("error")):c(this).addClass("error")}),!1}).blur(function(){return t.element.val(t.color),c.proxy(t.options.onColorSelected,t)(),t.hide(),!1}),c(document).on("click",function(e){if(!c.contains(t.element[0],e.target))return t.hide(),!0}),this},appendToStorage:function(e){var o;!0===c.fn.colorPicker.defaults.allowRecent&&(o=JSON.parse(localStorage.getItem("color-picker-recent")),-1==c.inArray(e,o=null==o?[]:o)&&(o.unshift(e),o=o.slice(0,c.fn.colorPicker.defaults.recentMax),localStorage.setItem("color-picker-recent",JSON.stringify(o))))},show:function(e,o,t){c(".color-picker-wrapper").remove();var r=(r=(r='<div class="color-picker-wrapper">')+'<div id="color-picker" style="display:none;top:'+(t+"px;left:"+o+'px"><span>'))+c.fn.colorPicker.defaults.paletteLabel+"</span></div></div>";c(e).prepend(r),c.each(this.palette,function(e,o){c("#color-picker").append('<div class="color-picker-button" hexValue="'+o+'" style="background:'+o+'"></div>')}),!0===c.fn.colorPicker.defaults.allowCustomColor&&c("#color-picker").append('<input type="text" style="margin-top:5px" class="color-custom-hash">'),!0===c.fn.colorPicker.defaults.allowRecent&&(c("#color-picker").append('<span style="margin-top:5px">'+c.fn.colorPicker.defaults.recentLabel+"</span>"),null==JSON.parse(localStorage.getItem("color-picker-recent"))||JSON.parse(localStorage.getItem("color-picker-recent"))==[]?c("#color-picker").append('<div class="color-picker-button color-picker-dummy"></div>'):c.each(JSON.parse(localStorage.getItem("color-picker-recent")),function(e,o){if(c("#color-picker").append('<div class="color-picker-button" hexValue="'+o+'" style="background:'+o+'"></div>'),e==c.fn.colorPicker.defaults.recentMax-1)return!1})),c("#color-picker").fadeIn(200)},hide:function(){c(".color-picker-wrapper").fadeOut(200,function(){return c(".color-picker-wrapper").remove(),this})}}}(jQuery);